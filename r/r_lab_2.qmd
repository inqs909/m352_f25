---
title: "RLab 2: Probability Distributions"
editor: visual
date: 03-01-2022
draft: true
---

## Setup

If you want to use the custom R Markdown templates for this course install the following packages:

```{r}
#| eval: false
install.packages("remotes") # Allows you to install packages from GitHub
remotes::install_github("inqs909/inqstools") # Installs my R package for the course
```

## Probability

We will discuss several R functions used for different probability distributions

### Distributions

To see what distributions R supports, use

``` default
?Distributions
```

or

``` default
help(Distributions)
```

for more information. Every distribution has four different functions associated to them. The letter at the beginning of the distribution indicates the functions capabilities.

| Letter | Functionality                                                  |
|:-------|:---------------------------------------------------------------|
| "d"    | returns the height of the probability density function         |
| "p"    | returns the cummulative density function value                 |
| "q"    | returns the inverse cummulative density function (percentiles) |
| "r"    | returns a randomly generated number                            |

### Probabilities

R can compute the probabilities of a distribution given the correct parameters. If you need the cummulative probability, `p` in front of the distribution function is needed. If you need the probability for a discrete distribution, the `d` in front of the distribution function is needed. Below are a few examples.

To find $P(X \leq 3 )$ where $X \sim N(5,2)$. Here we will use the `pnorm()` function and we set `q = 3`, `mean = 5` and `sd = sqrt(2)`.

```{r}
pnorm(3, 5, sqrt(2))
```

To find $P(X \geq 7 )$ where $X \sim Norm(5, 2)$. Here we will use the `pnorm()` and we set `q = 7`, `mean = 5`, `sd = sqrt(2)`, and `lower.tail = F`.

```{r}
pnorm(7, 5, sqrt(2), F)
```

### Percentiles

Percentiles identify the $x_0$ that satisfies $P(X \le x_0)=p$, where p is the percentile.

Finding the $95^{th}$ percentile from a $N(10, 5)$, we will use the `qnorm()`. We will set `mean=10`, `sd=sqrt(5)`, and `p=0.95`.

```{r}
qnorm(.95, 10, sqrt(5))
```

Finding the $95^{th}$ percentile from a $Gamma(6,9)$, we will use the `qgamma()`. We will set `shape=6`, `scale = 9`, and `p=0.95`.

```{r}
qgamma(.95, shape = 6, scale = 9)
```

### Random Number Generator

R is capable of generating random numbers. For example if we want to generate a random sample of size fifty from a normal distribution with mean eight and variance three, we will use the `rnorm()`. If we want to generate a random sample from any distribution, use the distribution function with `r` in front of it.

Let's first generate the random sample of fifty from $X \sim Normn(2.8, 1.3)$. This is done with the `rnorm()` and setting `n = 50`, `mean = 2.8` and `sd = sqrt(1.3)`.

```{r}
rnorm(50, 2.8, sqrt(1.3))
```

No let's generate a random sample of 100 form an $X \sim Beta(2,4)$. This is done by using the `rbeta()` and setting `n = 100`, `shape1 = 2`, and `shape2 = 4`.

```{r}
rbeta(100, 2, 4)
```

## Histograms

Histograms are used to plot the frequencies of observed values of a random variable. This provides a rough estimate of how a distribution function will look like. Below, we will use the `hist()` function to plot the distribution of a random sample of 1000 generated from a $Exp(1.3)$:

```{r}
x <- rexp(1000, 1.3)
hist(x)
```

Looking at the plot above, we can see that the mos common values are around 6. This is to be expected because the $E(X)=6$ from the binomial distribution. Another way to roughly estimate the expected value is by taking the mean:

```{r}
mean(x)
```

Notice how close it is to the expected value. If we are interested in computing the $E(X^2)$, we can roughly estimate it by squaring all the values and taking the mean of it:

```{r}
mean(x^2)
```

Now, we know that the variance of a binomial distribution is $np(1-p)$ which leads the $Var(X)=4.2$ with the above distribution. We can roughly estimate the variance with the rough estimates of $E(X^2)-E(X)^2$:

```{r}
mean(x^2) - mean(x)^2
```

While it is not exact, it can give you a rough idea.

## Problems

Use an RMD file to answer the following questions:

1.  Find the following probabilities:
    a.  $X\sim N(3, 3.5)$; Find $P(2 \le X \le 6)$

    b.  $X\sim Beta(6,8)$; Find $P(0.5 \le X \le .7)$

    c.  $X\sim Unif(6,25)$; Find $P(16 \le X \le 23)$
2.  Find the following percentiles:
    a.  $X\sim Unif(1,5)$; Find the $68$th percentile.
    b.  $X\sim N(17, 6)$; Find the $52$th percentile.
    c.  $X\sim Exp(1)$; Find the $43$th percentile.
3.  Generate the 50 realizations of the following random variables:
    a.  $X\sim Weibull(3,2)$

    b.  $X\sim Laplace(2,1/2)$[^1]

    c.  $X\sim LogNorm(0.5, \sqrt 2)$
4.  Generate 500 realizations of the following random variables and create a histogram:
    1.  $X\sim Exp(1.5)$

    2.  $X \sim Exp(2)$

    3.  $X \sim Exp(5)$

    4.  $X\sim Exp(10)$
5.  Generate 5000 realizations of $X\sim Gamma(7, 12)$ and compute the following rough estimates:
    1.  $E(X)$

    2.  $E(X^2)$

    3.  $Var(X)$

[^1]: You will need to install the VGAM R package.

Submit your Lab assignment as an RMD file in Canvas on 3/10/2023 by 11:59 PM.